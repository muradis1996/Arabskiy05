<!doctype html>
<html lang="ru">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ê—Ä–∞–±—Å–∫–∏–π –¥–ª—è –ö–æ—Ä–∞–Ω–∞</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
      color: #e0e6ed;
      min-height: 100%;
      overflow-x: hidden;
    }

    html, body {
      height: 100%;
    }

    .app-container {
      display: flex;
      flex-direction: column;
      height: 100%;
      max-width: 100%;
      margin: 0 auto;
    }

    /* Splash Screen */
    .splash-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      animation: fadeOut 0.5s ease-out 1s forwards;
    }

    .splash-logo {
      font-size: 2.5rem;
      font-weight: bold;
      background: linear-gradient(135deg, #00d4ff, #7b2ff7);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1rem;
      animation: glow 1.5s ease-in-out infinite;
    }

    .splash-subtitle {
      font-size: 1rem;
      color: #8b92a8;
      opacity: 0.8;
    }

    @keyframes fadeOut {
      to {
        opacity: 0;
        visibility: hidden;
      }
    }

    @keyframes glow {
      0%, 100% { filter: drop-shadow(0 0 10px rgba(0, 212, 255, 0.5)); }
      50% { filter: drop-shadow(0 0 20px rgba(123, 47, 247, 0.8)); }
    }

    /* Header */
    .header {
      background: rgba(26, 31, 58, 0.8);
      backdrop-filter: blur(10px);
      padding: 1.2rem 1.5rem;
      border-bottom: 2px solid rgba(0, 212, 255, 0.3);
      box-shadow: 0 4px 20px rgba(0, 212, 255, 0.1);
    }

    .header-title {
      font-size: 1.8rem;
      font-weight: bold;
      background: linear-gradient(135deg, #00d4ff, #7b2ff7);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-align: center;
    }

    .export-btn, .import-btn {
      background: rgba(0, 212, 255, 0.1);
      border: 2px solid rgba(0, 212, 255, 0.3);
      color: #00d4ff;
      padding: 0.6rem 1rem;
      border-radius: 10px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .export-btn:hover, .import-btn:hover {
      transform: scale(1.1);
      background: rgba(0, 212, 255, 0.2);
      border-color: rgba(0, 212, 255, 0.8);
      box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      overflow-y: auto;
      padding: 1.5rem;
      padding-bottom: 5rem;
    }

    /* Lessons Section */
    .lessons-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .lesson-card {
      background: linear-gradient(135deg, rgba(26, 31, 58, 0.9), rgba(42, 47, 78, 0.9));
      border: 2px solid rgba(0, 212, 255, 0.3);
      border-radius: 16px;
      padding: 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      animation: slideUp 0.5s ease-out;
    }

    .lesson-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(0, 212, 255, 0.1) 0%, transparent 70%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .lesson-card:hover {
      transform: translateY(-8px) scale(1.02);
      border-color: rgba(0, 212, 255, 0.8);
      box-shadow: 0 8px 30px rgba(0, 212, 255, 0.3);
    }

    .lesson-card:hover::before {
      opacity: 1;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .lesson-number {
      font-size: 2.5rem;
      font-weight: bold;
      background: linear-gradient(135deg, #00d4ff, #7b2ff7);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.5rem;
    }

    .lesson-title {
      font-size: 1.2rem;
      margin-bottom: 0.5rem;
      color: #e0e6ed;
    }

    .lesson-progress {
      font-size: 0.9rem;
      color: #8b92a8;
      margin-bottom: 1rem;
    }

    .lesson-status {
      display: inline-block;
      padding: 0.4rem 1rem;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .status-new {
      background: rgba(123, 47, 247, 0.2);
      color: #b794f6;
      border: 1px solid rgba(123, 47, 247, 0.5);
    }

    .status-completed {
      background: rgba(0, 212, 255, 0.2);
      color: #00d4ff;
      border: 1px solid rgba(0, 212, 255, 0.5);
    }

    /* Lesson Detail View */
    .lesson-detail {
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .back-button {
      background: rgba(26, 31, 58, 0.8);
      border: 2px solid rgba(0, 212, 255, 0.3);
      color: #00d4ff;
      padding: 0.8rem 1.5rem;
      border-radius: 12px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-bottom: 1.5rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .back-button:hover {
      transform: scale(1.05);
      background: rgba(0, 212, 255, 0.1);
      border-color: rgba(0, 212, 255, 0.8);
      box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3);
    }

    .words-list {
      display: grid;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .word-card {
      background: linear-gradient(135deg, rgba(26, 31, 58, 0.9), rgba(42, 47, 78, 0.9));
      border: 2px solid rgba(123, 47, 247, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .word-card:hover {
      transform: translateX(8px);
      border-color: rgba(123, 47, 247, 0.8);
      box-shadow: 0 4px 20px rgba(123, 47, 247, 0.3);
    }

    .word-arabic {
      font-size: 2rem;
      font-weight: bold;
      color: #00d4ff;
      direction: rtl;
    }

    .word-translation {
      font-size: 1.2rem;
      color: #e0e6ed;
    }

    .start-training-btn {
      width: 100%;
      background: linear-gradient(135deg, #00d4ff, #7b2ff7);
      border: none;
      color: white;
      padding: 1.2rem;
      border-radius: 12px;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(0, 212, 255, 0.4);
    }

    .start-training-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 30px rgba(0, 212, 255, 0.6);
    }

    /* Training View */
    .training-container {
      max-width: 600px;
      margin: 0 auto;
    }

    .training-progress {
      background: rgba(26, 31, 58, 0.8);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 2rem;
      text-align: center;
    }

    .progress-text {
      font-size: 1.1rem;
      color: #8b92a8;
      margin-bottom: 0.5rem;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(123, 47, 247, 0.2);
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #00d4ff, #7b2ff7);
      transition: width 0.3s ease;
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
    }

    .question-card {
      background: linear-gradient(135deg, rgba(26, 31, 58, 0.9), rgba(42, 47, 78, 0.9));
      border: 2px solid rgba(0, 212, 255, 0.3);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      animation: slideUp 0.5s ease-out;
    }

    .question-text {
      font-size: 1.3rem;
      color: #e0e6ed;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .question-arabic {
      font-size: 3rem;
      font-weight: bold;
      color: #00d4ff;
      text-align: center;
      margin: 2rem 0;
      direction: rtl;
    }

    .options-grid {
      display: grid;
      gap: 1rem;
    }

    .option-btn {
      background: rgba(26, 31, 58, 0.8);
      border: 2px solid rgba(123, 47, 247, 0.3);
      color: #e0e6ed;
      padding: 1.2rem;
      border-radius: 12px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: left;
    }

    .option-btn:hover {
      transform: scale(1.02);
      border-color: rgba(123, 47, 247, 0.8);
      background: rgba(123, 47, 247, 0.1);
    }

    .option-btn.correct {
      background: rgba(0, 255, 136, 0.2);
      border-color: #00ff88;
      color: #00ff88;
    }

    .option-btn.incorrect {
      background: rgba(255, 68, 68, 0.2);
      border-color: #ff4444;
      color: #ff4444;
    }

    .motivation-message {
      background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(123, 47, 247, 0.1));
      border: 2px solid rgba(0, 212, 255, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
      font-size: 1.1rem;
      color: #00d4ff;
      margin-top: 1rem;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }

    @keyframes slideUp {
      from {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
      to {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
      }
    }

    /* Dictionary Section */
    .dictionary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .dict-card {
      background: linear-gradient(135deg, rgba(26, 31, 58, 0.9), rgba(42, 47, 78, 0.9));
      border: 2px solid rgba(0, 212, 255, 0.3);
      border-radius: 16px;
      padding: 2rem;
      cursor: pointer;
      transition: all 0.6s ease;
      transform-style: preserve-3d;
      min-height: 180px;
      position: relative;
    }

    .dict-card:hover {
      border-color: rgba(123, 47, 247, 0.8);
    }

    .dict-card.flipped .dict-card-front {
      transform: rotateY(180deg);
    }

    .dict-card.flipped .dict-card-back {
      transform: rotateY(0deg);
    }

    .dict-card-front, .dict-card-back {
      backface-visibility: hidden;
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 2rem;
      transition: transform 0.6s ease;
      top: 0;
      left: 0;
      border-radius: 16px;
    }

    .dict-card-back {
      transform: rotateY(-180deg);
    }

    /* Verbs Section */
    .verb-exercise {
      max-width: 700px;
      margin: 0 auto;
    }

    /* Sentence Training */
    .sentence-builder {
      background: linear-gradient(135deg, rgba(26, 31, 58, 0.9), rgba(42, 47, 78, 0.9));
      border: 2px solid rgba(0, 212, 255, 0.3);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .drop-zone {
      min-height: 100px;
      background: rgba(123, 47, 247, 0.1);
      border: 2px dashed rgba(123, 47, 247, 0.5);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 2rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      justify-content: center;
    }

    .word-chip {
      background: linear-gradient(135deg, #00d4ff, #7b2ff7);
      color: white;
      padding: 0.8rem 1.5rem;
      border-radius: 25px;
      cursor: move;
      transition: all 0.2s ease;
      font-size: 1.1rem;
      user-select: none;
    }

    .word-chip:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 15px rgba(0, 212, 255, 0.5);
    }

    .word-chip.dragging {
      opacity: 0.5;
    }

    .words-pool {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
    }

    .check-btn {
      width: 100%;
      background: linear-gradient(135deg, #00d4ff, #7b2ff7);
      border: none;
      color: white;
      padding: 1rem;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 1rem;
    }

    .check-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 25px rgba(0, 212, 255, 0.5);
    }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(26, 31, 58, 0.95);
      backdrop-filter: blur(10px);
      border-top: 2px solid rgba(0, 212, 255, 0.3);
      display: flex;
      justify-content: space-around;
      padding: 1rem 0;
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.3rem;
      cursor: pointer;
      transition: all 0.2s ease;
      padding: 0.5rem 1rem;
      border-radius: 12px;
      color: #8b92a8;
    }

    .nav-item:hover {
      transform: scale(1.1);
    }

    .nav-item.active {
      color: #00d4ff;
      background: rgba(0, 212, 255, 0.1);
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
    }

    .nav-icon {
      font-size: 1.5rem;
    }

    .nav-label {
      font-size: 0.75rem;
      font-weight: 600;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 3rem 1rem;
      color: #8b92a8;
    }

    .empty-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .empty-text {
      font-size: 1.2rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header {
        padding: 1rem;
      }

      .header-title {
        font-size: 1.3rem;
      }

      .export-btn, .import-btn {
        padding: 0.5rem 0.8rem;
        font-size: 1rem;
      }

      .main-content {
        padding: 1rem;
        padding-bottom: 5rem;
      }

      .lessons-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .lesson-card {
        padding: 1.2rem;
      }

      .lesson-number {
        font-size: 2rem;
      }

      .dictionary-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 1rem;
      }

      .dict-card {
        min-height: 150px;
        padding: 1.5rem;
      }

      .word-arabic {
        font-size: 1.5rem;
      }

      .word-translation {
        font-size: 1rem;
      }

      .question-arabic {
        font-size: 2rem;
        margin: 1.5rem 0;
      }

      .question-card {
        padding: 1.5rem;
      }

      .option-btn {
        padding: 1rem;
        font-size: 1rem;
      }

      .word-chip {
        padding: 0.6rem 1.2rem;
        font-size: 1rem;
      }

      .bottom-nav {
        padding: 0.8rem 0;
      }

      .nav-icon {
        font-size: 1.3rem;
      }

      .nav-label {
        font-size: 0.7rem;
      }

      .splash-logo {
        font-size: 2rem;
      }

      .training-container {
        padding: 0;
      }

      .sentence-builder {
        padding: 1.5rem;
      }

      .drop-zone {
        min-height: 80px;
        padding: 0.8rem;
      }
    }

    @media (max-width: 480px) {
      .header-title {
        font-size: 1.1rem;
      }

      .lesson-number {
        font-size: 1.8rem;
      }

      .lesson-title {
        font-size: 1rem;
      }

      .question-arabic {
        font-size: 1.5rem;
      }

      .word-chip {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
      }

      .dict-card {
        min-height: 120px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="splash-screen">
   <div class="splash-logo">
    ‚ò™ ÿßŸÑŸÇÿ±ÿ¢ŸÜ
   </div>
   <div class="splash-subtitle">
    –ê—Ä–∞–±—Å–∫–∏–π –¥–ª—è –ö–æ—Ä–∞–Ω–∞
   </div>
  </div>
  <div class="app-container">
   <header class="header">
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
     <h1 class="header-title" id="appTitle" style="flex: 1; min-width: 200px;">‚ò™ –ê—Ä–∞–±—Å–∫–∏–π –¥–ª—è –ö–æ—Ä–∞–Ω–∞</h1>
     <div style="display: flex; gap: 0.5rem;"><button class="export-btn" id="exportBtn" title="–≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞">üì§</button> <button class="import-btn" id="importBtn" title="–ò–º–ø–æ—Ä—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞">üì•</button>
     </div>
    </div><input type="file" id="importFile" accept=".json" style="display: none;">
   </header>
   <main class="main-content" id="mainContent"><!-- Content will be dynamically loaded here -->
   </main>
   <nav class="bottom-nav">
    <div class="nav-item active" data-section="lessons">
     <div class="nav-icon">
      üìö
     </div>
     <div class="nav-label">
      –£—Ä–æ–∫–∏
     </div>
    </div>
    <div class="nav-item" data-section="dictionary">
     <div class="nav-icon">
      üìñ
     </div>
     <div class="nav-label">
      –°–ª–æ–≤–∞—Ä—å
     </div>
    </div>
    <div class="nav-item" data-section="verbs">
     <div class="nav-icon">
      ‚úçÔ∏è
     </div>
     <div class="nav-label">
      –ì–ª–∞–≥–æ–ª—ã
     </div>
    </div>
    <div class="nav-item" data-section="training">
     <div class="nav-icon">
      üéØ
     </div>
     <div class="nav-label">
      –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
     </div>
    </div>
   </nav>
  </div>
  <script>
    const LESSONS_DATA = [
      {
        id: 1,
        title: "–û—Å–Ω–æ–≤—ã –≤–µ—Ä—ã",
        words: [
          { arabic: "ÿßŸÑŸÑŸéŸëŸáŸè", translation: "–í—Å–µ–≤—ã—à–Ω–∏–π –ê–ª–ª–∞—Ö" },
          { arabic: "ÿ±Ÿéÿ®Ÿë", translation: "–ì–æ—Å–ø–æ–¥—å" },
          { arabic: "ŸÇŸéÿßŸÑŸé", translation: "—Å–∫–∞–∑–∞–ª" },
          { arabic: "ŸÉŸêÿ™Ÿéÿßÿ®", translation: "–∫–Ω–∏–≥–∞" },
          { arabic: "ŸÜŸéŸÅŸíÿ≥", translation: "–¥—É—à–∞" },
          { arabic: "ŸäŸéŸàŸíŸÖ", translation: "–¥–µ–Ω—å" },
          { arabic: "ÿ≠ŸéŸÇŸë", translation: "–∏—Å—Ç–∏–Ω–∞" },
          { arabic: "ÿπŸêŸÑŸíŸÖ", translation: "–∑–Ω–∞–Ω–∏–µ" },
          { arabic: "ÿ£Ÿéÿ±Ÿíÿ∂", translation: "–∑–µ–º–ª—è" },
          { arabic: "ÿ≥Ÿéÿ®ŸêŸäŸÑ", translation: "–ø—É—Ç—å" }
        ]
      },
      {
        id: 2,
        title: "–í–µ—Ä–∞ –∏ –Ω–µ–≤–µ—Ä–∏–µ",
        words: [
          { arabic: "ŸÖŸèÿ§ŸíŸÖŸêŸÜ", translation: "–≤–µ—Ä—É—é—â–∏–π" },
          { arabic: "ŸÉŸéÿßŸÅŸêÿ±", translation: "–Ω–µ–≤–µ—Ä—É—é—â–∏–π" },
          { arabic: "ŸáŸèÿØŸãŸâ", translation: "—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ" },
          { arabic: "ÿ±Ÿéÿ≠ŸíŸÖŸéÿ©", translation: "–º–∏–ª–æ—Å—Ç—å" },
          { arabic: "ŸÜŸèŸàÿ±", translation: "—Å–≤–µ—Ç" },
          { arabic: "ŸÇŸèŸàŸéŸëÿ©", translation: "—Å–∏–ª–∞" },
          { arabic: "ÿ¢ŸäŸéÿ©", translation: "–∑–Ω–∞–º–µ–Ω–∏–µ" },
          { arabic: "ÿ≥ŸéŸÖŸéÿßÿ°", translation: "–Ω–µ–±–æ" },
          { arabic: "ŸÖŸéÿßÿ°", translation: "–≤–æ–¥–∞" },
          { arabic: "ÿ¨ŸéŸÜŸéŸëÿ©", translation: "—Ä–∞–π" }
        ]
      },
      {
        id: 3,
        title: "–ú–∏—Ä –∏ –≤–µ—á–Ω–æ—Å—Ç—å",
        words: [
          { arabic: "ŸÜŸéÿßÿ±", translation: "–æ–≥–æ–Ω—å" },
          { arabic: "ŸÇŸéŸàŸíŸÖ", translation: "–Ω–∞—Ä–æ–¥" },
          { arabic: "ÿ≥Ÿéÿ®Ÿéÿ®", translation: "–ø—Ä–∏—á–∏–Ω–∞" },
          { arabic: "ÿ®Ÿéÿßÿ®", translation: "–¥–≤–µ—Ä—å" },
          { arabic: "ÿ∑Ÿéÿ±ŸêŸäŸÇ", translation: "–¥–æ—Ä–æ–≥–∞" },
          { arabic: "ÿØŸèŸÜŸíŸäŸéÿß", translation: "–º–∏—Ä" },
          { arabic: "ÿ£ŸéÿÆŸêŸäÿ±Ÿéÿ©", translation: "–≤–µ—á–Ω–æ—Å—Ç—å" },
          { arabic: "ÿØŸèÿπŸéÿßÿ°", translation: "–º–æ–ª—å–±–∞" },
          { arabic: "ÿ≠ŸèŸÉŸíŸÖ", translation: "—Ä–µ—à–µ–Ω–∏–µ" },
          { arabic: "ÿ±Ÿéÿ≥ŸèŸàŸÑ", translation: "–ø–æ—Å–ª–∞–Ω–Ω–∏–∫" }
        ]
      }
    ];

    const VERB_EXERCISES = [
      {
        sentence: "–û–Ω–∏ –∏–¥—É—Ç –≤ —à–∫–æ–ª—É",
        arabic: "... ÿ•ŸÑŸâ ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©",
        correctVerb: "Ÿäÿ∞Ÿáÿ®ŸàŸÜ",
        options: ["Ÿäÿ∞Ÿáÿ®", "Ÿäÿ∞Ÿáÿ®ŸàŸÜ", "ÿ∞Ÿáÿ®"],
        translations: ["–æ–Ω –∏–¥—ë—Ç", "–æ–Ω–∏ –∏–¥—É—Ç", "–æ–Ω –ø–æ—à—ë–ª"]
      },
      {
        sentence: "–û–Ω —Å–∫–∞–∑–∞–ª –∏—Å—Ç–∏–Ω—É",
        arabic: "... ÿßŸÑÿ≠ŸéŸÇŸë",
        correctVerb: "ŸÇŸéÿßŸÑŸé",
        options: ["ŸÇŸéÿßŸÑŸé", "ŸäŸéŸÇŸèŸàŸÑ", "ŸÇŸéÿßŸÑŸèŸàÿß"],
        translations: ["–æ–Ω —Å–∫–∞–∑–∞–ª", "–æ–Ω –≥–æ–≤–æ—Ä–∏—Ç", "–æ–Ω–∏ —Å–∫–∞–∑–∞–ª–∏"]
      },
      {
        sentence: "–ú—ã –∑–Ω–∞–µ–º –ø—É—Ç—å",
        arabic: "... ÿßŸÑÿ≥Ÿéÿ®ŸêŸäŸÑ",
        correctVerb: "ŸÜŸéÿπŸíŸÑŸéŸÖ",
        options: ["ŸäŸéÿπŸíŸÑŸéŸÖ", "ŸÜŸéÿπŸíŸÑŸéŸÖ", "ÿπŸéŸÑŸêŸÖŸé"],
        translations: ["–æ–Ω –∑–Ω–∞–µ—Ç", "–º—ã –∑–Ω–∞–µ–º", "–æ–Ω —É–∑–Ω–∞–ª"]
      }
    ];

    const SENTENCE_EXERCISES = [
      {
        sentence: "–ê–ª–ª–∞—Ö ‚Äî –ì–æ—Å–ø–æ–¥—å –º–∏—Ä–æ–≤",
        words: ["ÿßŸÑŸÑŸéŸëŸáŸè", "ÿ±Ÿéÿ®Ÿë", "ÿßŸÑÿπÿßŸÑŸÖŸäŸÜ"],
        correct: ["ÿßŸÑŸÑŸéŸëŸáŸè", "ÿ±Ÿéÿ®Ÿë", "ÿßŸÑÿπÿßŸÑŸÖŸäŸÜ"],
        lessonId: 1
      },
      {
        sentence: "–≠—Ç–æ –∫–Ω–∏–≥–∞ –∏—Å—Ç–∏–Ω—ã",
        words: ["Ÿáÿ∞ÿß", "ŸÉŸêÿ™Ÿéÿßÿ®", "ÿßŸÑÿ≠ŸéŸÇŸë"],
        correct: ["Ÿáÿ∞ÿß", "ŸÉŸêÿ™Ÿéÿßÿ®", "ÿßŸÑÿ≠ŸéŸÇŸë"],
        lessonId: 1
      },
      {
        sentence: "–ó–Ω–∞–Ω–∏–µ ‚Äî —ç—Ç–æ –ø—É—Ç—å",
        words: ["ÿßŸÑÿπŸêŸÑŸíŸÖ", "ŸáŸà", "ÿßŸÑÿ≥Ÿéÿ®ŸêŸäŸÑ"],
        correct: ["ÿßŸÑÿπŸêŸÑŸíŸÖ", "ŸáŸà", "ÿßŸÑÿ≥Ÿéÿ®ŸêŸäŸÑ"],
        lessonId: 1
      },
      {
        sentence: "–î–µ–Ω—å —Å—É–¥–∞ –Ω–∞ –∑–µ–º–ª–µ",
        words: ["ŸäŸéŸàŸíŸÖ", "ÿßŸÑÿ≠ÿ≥ÿßÿ®", "ŸÅŸä", "ÿßŸÑÿ£Ÿéÿ±Ÿíÿ∂"],
        correct: ["ŸäŸéŸàŸíŸÖ", "ÿßŸÑÿ≠ÿ≥ÿßÿ®", "ŸÅŸä", "ÿßŸÑÿ£Ÿéÿ±Ÿíÿ∂"],
        lessonId: 1
      },
      {
        sentence: "–í–µ—Ä—É—é—â–∏–π –∏–¥–µ—Ç –ø–æ –ø—É—Ç–∏ —Å–≤–µ—Ç–∞",
        words: ["ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ", "ŸäŸÖÿ¥Ÿä", "ŸÅŸä", "ÿ∑ÿ±ŸäŸÇ", "ÿßŸÑŸÜŸèŸàÿ±"],
        correct: ["ÿßŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜ", "ŸäŸÖÿ¥Ÿä", "ŸÅŸä", "ÿ∑ÿ±ŸäŸÇ", "ÿßŸÑŸÜŸèŸàÿ±"],
        lessonId: 2
      },
      {
        sentence: "–ú–∏–ª–æ—Å—Ç—å –ê–ª–ª–∞—Ö–∞ –≤–µ–ª–∏–∫–∞",
        words: ["ÿ±Ÿéÿ≠ŸíŸÖŸéÿ©", "ÿßŸÑŸÑŸéŸëŸáŸè", "ŸÉÿ®Ÿäÿ±ÿ©"],
        correct: ["ÿ±Ÿéÿ≠ŸíŸÖŸéÿ©", "ÿßŸÑŸÑŸéŸëŸáŸè", "ŸÉÿ®Ÿäÿ±ÿ©"],
        lessonId: 2
      },
      {
        sentence: "–≠—Ç–æ –∑–Ω–∞–º–µ–Ω–∏–µ —Å –Ω–µ–±–µ—Å",
        words: ["Ÿáÿ∞Ÿá", "ÿ¢ŸäŸéÿ©", "ŸÖŸÜ", "ÿßŸÑÿ≥ŸéŸÖŸéÿßÿ°"],
        correct: ["Ÿáÿ∞Ÿá", "ÿ¢ŸäŸéÿ©", "ŸÖŸÜ", "ÿßŸÑÿ≥ŸéŸÖŸéÿßÿ°"],
        lessonId: 2
      },
      {
        sentence: "–í–æ–¥–∞ ‚Äî —ç—Ç–æ –º–∏–ª–æ—Å—Ç—å –¥–ª—è –Ω–∞—Ä–æ–¥–∞",
        words: ["ÿßŸÑŸÖŸéÿßÿ°", "ÿ±Ÿéÿ≠ŸíŸÖŸéÿ©", "ŸÑŸÑŸÇŸéŸàŸíŸÖ"],
        correct: ["ÿßŸÑŸÖŸéÿßÿ°", "ÿ±Ÿéÿ≠ŸíŸÖŸéÿ©", "ŸÑŸÑŸÇŸéŸàŸíŸÖ"],
        lessonId: 2
      },
      {
        sentence: "–†–∞–π ‚Äî –Ω–∞–≥—Ä–∞–¥–∞ –≤–µ—Ä—É—é—â–∏–º",
        words: ["ÿßŸÑÿ¨ŸéŸÜŸéŸëÿ©", "ÿ¨ÿ≤ÿßÿ°", "ŸÑŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜŸäŸÜ"],
        correct: ["ÿßŸÑÿ¨ŸéŸÜŸéŸëÿ©", "ÿ¨ÿ≤ÿßÿ°", "ŸÑŸÑŸÖŸèÿ§ŸíŸÖŸêŸÜŸäŸÜ"],
        lessonId: 2
      },
      {
        sentence: "–ü–æ—Å–ª–∞–Ω–Ω–∏–∫ –æ—Ç–∫—Ä—ã–ª –¥–≤–µ—Ä—å –∑–Ω–∞–Ω–∏—è",
        words: ["ÿßŸÑÿ±Ÿéÿ≥ŸèŸàŸÑ", "ŸÅÿ™ÿ≠", "ÿ®Ÿéÿßÿ®", "ÿßŸÑÿπŸêŸÑŸíŸÖ"],
        correct: ["ÿßŸÑÿ±Ÿéÿ≥ŸèŸàŸÑ", "ŸÅÿ™ÿ≠", "ÿ®Ÿéÿßÿ®", "ÿßŸÑÿπŸêŸÑŸíŸÖ"],
        lessonId: 3
      },
      {
        sentence: "–ú–∏—Ä ‚Äî —ç—Ç–æ –¥–æ—Ä–æ–≥–∞ –∫ –≤–µ—á–Ω–æ—Å—Ç–∏",
        words: ["ÿßŸÑÿØŸèŸÜŸíŸäŸéÿß", "ÿ∑Ÿéÿ±ŸêŸäŸÇ", "ÿ•ŸÑŸâ", "ÿßŸÑÿ£ŸéÿÆŸêŸäÿ±Ÿéÿ©"],
        correct: ["ÿßŸÑÿØŸèŸÜŸíŸäŸéÿß", "ÿ∑Ÿéÿ±ŸêŸäŸÇ", "ÿ•ŸÑŸâ", "ÿßŸÑÿ£ŸéÿÆŸêŸäÿ±Ÿéÿ©"],
        lessonId: 3
      },
      {
        sentence: "–ú–æ–ª—å–±–∞ ‚Äî –ø—Ä–∏—á–∏–Ω–∞ –º–∏–ª–æ—Å—Ç–∏",
        words: ["ÿßŸÑÿØŸèÿπŸéÿßÿ°", "ÿ≥Ÿéÿ®Ÿéÿ®", "ÿßŸÑÿ±Ÿéÿ≠ŸíŸÖŸéÿ©"],
        correct: ["ÿßŸÑÿØŸèÿπŸéÿßÿ°", "ÿ≥Ÿéÿ®Ÿéÿ®", "ÿßŸÑÿ±Ÿéÿ≠ŸíŸÖŸéÿ©"],
        lessonId: 3
      },
      {
        sentence: "–†–µ—à–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–∞ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ",
        words: ["ÿ≠ŸèŸÉŸíŸÖ", "ÿßŸÑÿ±Ÿéÿ®Ÿë", "ÿπÿßÿØŸÑ"],
        correct: ["ÿ≠ŸèŸÉŸíŸÖ", "ÿßŸÑÿ±Ÿéÿ®Ÿë", "ÿπÿßÿØŸÑ"],
        lessonId: 3
      },
      {
        sentence: "–û–≥–æ–Ω—å –¥–ª—è –Ω–µ–≤–µ—Ä—É—é—â–∏—Ö",
        words: ["ÿßŸÑŸÜŸéÿßÿ±", "ŸÑŸÑŸÉŸéÿßŸÅŸêÿ±ŸäŸÜ"],
        correct: ["ÿßŸÑŸÜŸéÿßÿ±", "ŸÑŸÑŸÉŸéÿßŸÅŸêÿ±ŸäŸÜ"],
        lessonId: 3
      }
    ];

    const defaultConfig = {
      app_title: "‚ò™ –ê—Ä–∞–±—Å–∫–∏–π –¥–ª—è –ö–æ—Ä–∞–Ω–∞",
      motivation_1: "–ü—Ä–æ–¥–æ–ª–∂–∞–π, —Ç—ã –±–ª–∏–∂–µ –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é –ö–æ—Ä–∞–Ω–∞",
      motivation_2: "–ï—â—ë –æ–¥–Ω–æ —Å–ª–æ–≤–æ ‚Äî –µ—â—ë –æ–¥–∏–Ω —à–∞–≥ –∫ –∑–Ω–∞–Ω–∏—é",
      motivation_3: "–ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è!",
      primary_color: "#00d4ff",
      secondary_color: "#7b2ff7",
      background_color: "#0a0e27",
      surface_color: "#1a1f3a",
      text_color: "#e0e6ed",
      font_family: "Segoe UI",
      font_size: 16
    };

    let currentSection = 'lessons';
    let currentLesson = null;
    let currentTraining = null;
    let trainingProgress = 0;
    let completedLessons = new Set();
    let learnedWords = [];

    const dataHandler = {
      onDataChanged(data) {
        learnedWords = data;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤
        const lessonIds = [...new Set(data.map(w => w.lesson_id))];
        completedLessons = new Set(lessonIds);
        
        // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–¥–µ–ª
        switch(currentSection) {
          case 'lessons':
            if (!currentLesson && !currentTraining) {
              renderLessons();
            }
            break;
          case 'dictionary':
            renderDictionary();
            break;
          case 'verbs':
            renderVerbs();
            break;
          case 'training':
            renderSentenceTraining();
            break;
        }
      }
    };

    async function initApp() {
      const initResult = await window.dataSdk.init(dataHandler);
      if (!initResult.isOk) {
        console.error("Failed to initialize data SDK");
      }

      await window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (config) => {
          const appTitle = document.getElementById('appTitle');
          if (appTitle) {
            appTitle.textContent = config.app_title || defaultConfig.app_title;
          }

          const customFont = config.font_family || defaultConfig.font_family;
          const baseSize = config.font_size || defaultConfig.font_size;
          const baseFontStack = 'Tahoma, Geneva, Verdana, sans-serif';

          document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
          document.body.style.fontSize = `${baseSize}px`;

          const root = document.documentElement;
          root.style.setProperty('--primary-color', config.primary_color || defaultConfig.primary_color);
          root.style.setProperty('--secondary-color', config.secondary_color || defaultConfig.secondary_color);
          root.style.setProperty('--background-color', config.background_color || defaultConfig.background_color);
          root.style.setProperty('--surface-color', config.surface_color || defaultConfig.surface_color);
          root.style.setProperty('--text-color', config.text_color || defaultConfig.text_color);

          document.querySelectorAll('.header-title, .splash-logo, .lesson-number').forEach(el => {
            el.style.background = `linear-gradient(135deg, ${config.primary_color || defaultConfig.primary_color}, ${config.secondary_color || defaultConfig.secondary_color})`;
            el.style.webkitBackgroundClip = 'text';
            el.style.webkitTextFillColor = 'transparent';
            el.style.backgroundClip = 'text';
          });

          document.querySelectorAll('.word-arabic, .question-arabic').forEach(el => {
            el.style.color = config.primary_color || defaultConfig.primary_color;
          });

          document.querySelectorAll('.start-training-btn, .check-btn, .word-chip').forEach(el => {
            el.style.background = `linear-gradient(135deg, ${config.primary_color || defaultConfig.primary_color}, ${config.secondary_color || defaultConfig.secondary_color})`;
          });

          document.querySelectorAll('.lesson-card, .word-card, .dict-card, .question-card, .sentence-builder').forEach(el => {
            el.style.background = `linear-gradient(135deg, ${config.surface_color || defaultConfig.surface_color}, rgba(42, 47, 78, 0.9))`;
            el.style.borderColor = `${config.primary_color || defaultConfig.primary_color}50`;
          });

          document.body.style.background = `linear-gradient(135deg, ${config.background_color || defaultConfig.background_color}, ${config.surface_color || defaultConfig.surface_color})`;
        },
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                window.elementSdk.config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.surface_color || defaultConfig.surface_color,
              set: (value) => {
                window.elementSdk.config.surface_color = value;
                window.elementSdk.setConfig({ surface_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                window.elementSdk.config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.primary_color || defaultConfig.primary_color,
              set: (value) => {
                window.elementSdk.config.primary_color = value;
                window.elementSdk.setConfig({ primary_color: value });
              }
            },
            {
              get: () => config.secondary_color || defaultConfig.secondary_color,
              set: (value) => {
                window.elementSdk.config.secondary_color = value;
                window.elementSdk.setConfig({ secondary_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              window.elementSdk.config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              window.elementSdk.config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["app_title", config.app_title || defaultConfig.app_title],
          ["motivation_1", config.motivation_1 || defaultConfig.motivation_1],
          ["motivation_2", config.motivation_2 || defaultConfig.motivation_2],
          ["motivation_3", config.motivation_3 || defaultConfig.motivation_3]
        ])
      });

      setupNavigation();
      setupExportImport();
      renderLessons();
    }

    function setupExportImport() {
      const exportBtn = document.getElementById('exportBtn');
      const importBtn = document.getElementById('importBtn');
      const importFile = document.getElementById('importFile');

      exportBtn.addEventListener('click', () => {
        const exportData = {
          version: 1,
          timestamp: new Date().toISOString(),
          words: learnedWords,
          completedLessons: Array.from(completedLessons)
        };

        const dataStr = JSON.stringify(exportData, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `arabic-progress-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        URL.revokeObjectURL(url);

        showNotification('‚úì –ü—Ä–æ–≥—Ä–µ—Å—Å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!');
      });

      importBtn.addEventListener('click', () => {
        importFile.click();
      });

      importFile.addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        try {
          const text = await file.text();
          const importData = JSON.parse(text);

          if (!importData.words || !Array.isArray(importData.words)) {
            showNotification('‚úó –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞', true);
            return;
          }

          // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–ª–æ–≤–∞
          for (const word of learnedWords) {
            await window.dataSdk.delete(word);
          }

          // –î–æ–±–∞–≤–ª—è–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞
          for (const word of importData.words) {
            const createResult = await window.dataSdk.create({
              lesson_id: word.lesson_id,
              word: word.word,
              translation: word.translation,
              completed: word.completed
            });

            if (!createResult.isOk) {
              console.error("Failed to import word");
            }
          }

          showNotification('‚úì –ü—Ä–æ–≥—Ä–µ—Å—Å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!');
          importFile.value = '';
        } catch (error) {
          showNotification('‚úó –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ', true);
          console.error(error);
        }
      });
    }

    function showNotification(message, isError = false) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 5rem;
        left: 50%;
        transform: translateX(-50%);
        background: ${isError ? 'rgba(255, 68, 68, 0.95)' : 'rgba(0, 212, 255, 0.95)'};
        color: white;
        padding: 1rem 2rem;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 600;
        z-index: 10000;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        animation: slideDown 0.3s ease-out;
      `;
      notification.textContent = message;
      document.body.appendChild(notification);

      setTimeout(() => {
        notification.style.animation = 'slideUp 0.3s ease-out';
        setTimeout(() => notification.remove(), 300);
      }, 2000);
    }

    function setupNavigation() {
      document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', () => {
          document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          
          currentSection = item.dataset.section;
          
          switch(currentSection) {
            case 'lessons':
              renderLessons();
              break;
            case 'dictionary':
              renderDictionary();
              break;
            case 'verbs':
              renderVerbs();
              break;
            case 'training':
              renderSentenceTraining();
              break;
          }
        });
      });
    }

    function renderLessons() {
      const content = document.getElementById('mainContent');
      
      if (currentLesson) {
        renderLessonDetail(currentLesson);
        return;
      }

      const lessonsHTML = LESSONS_DATA.map((lesson, index) => {
        const isCompleted = completedLessons.has(lesson.id);
        
        return `
          <div class="lesson-card" data-lesson-id="${lesson.id}">
            <div class="lesson-number">${lesson.id}</div>
            <div class="lesson-title">${lesson.title}</div>
            <div class="lesson-progress">${lesson.words.length} —Å–ª–æ–≤</div>
            <div class="lesson-status ${isCompleted ? 'status-completed' : 'status-new'}">
              ${isCompleted ? '‚úì –ó–∞–≤–µ—Ä—à—ë–Ω' : '–ù–æ–≤—ã–π'}
            </div>
          </div>
        `;
      }).join('');

      content.innerHTML = `
        <div class="lessons-grid">
          ${lessonsHTML}
        </div>
      `;

      document.querySelectorAll('.lesson-card').forEach(card => {
        card.addEventListener('click', () => {
          const lessonId = parseInt(card.dataset.lessonId);
          currentLesson = LESSONS_DATA.find(l => l.id === lessonId);
          renderLessonDetail(currentLesson);
        });
      });
    }

    function renderLessonDetail(lesson) {
      const content = document.getElementById('mainContent');
      
      const wordsHTML = lesson.words.map(word => `
        <div class="word-card">
          <div class="word-arabic">${word.arabic}</div>
          <div class="word-translation">${word.translation}</div>
        </div>
      `).join('');

      content.innerHTML = `
        <div class="lesson-detail">
          <button class="back-button">‚Üê –ù–∞–∑–∞–¥</button>
          <h2 style="color: #00d4ff; margin-bottom: 1.5rem; font-size: 1.8rem;">–£—Ä–æ–∫ ${lesson.id}: ${lesson.title}</h2>
          <div class="words-list">
            ${wordsHTML}
          </div>
          <button class="start-training-btn">–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
        </div>
      `;

      document.querySelector('.back-button').addEventListener('click', () => {
        currentLesson = null;
        renderLessons();
      });

      document.querySelector('.start-training-btn').addEventListener('click', () => {
        startTraining(lesson);
      });
    }

    async function startTraining(lesson) {
      currentTraining = {
        lesson: lesson,
        questions: generateQuestions(lesson),
        currentQuestion: 0,
        correctAnswers: 0
      };

      renderTrainingQuestion();
    }

    function generateQuestions(lesson) {
      const questions = [];
      
      lesson.words.forEach(word => {
        const otherWords = lesson.words.filter(w => w.arabic !== word.arabic);
        const wrongOptions = otherWords.sort(() => Math.random() - 0.5).slice(0, 2);
        const options = [word.translation, ...wrongOptions.map(w => w.translation)].sort(() => Math.random() - 0.5);
        
        questions.push({
          type: 'translation',
          arabic: word.arabic,
          correct: word.translation,
          options: options
        });
      });

      return questions.sort(() => Math.random() - 0.5);
    }

    function renderTrainingQuestion() {
      const content = document.getElementById('mainContent');
      const question = currentTraining.questions[currentTraining.currentQuestion];
      const progress = ((currentTraining.currentQuestion + 1) / currentTraining.questions.length) * 100;

      const optionsHTML = question.options.map(option => `
        <button class="option-btn" data-answer="${option}">${option}</button>
      `).join('');

      const config = window.elementSdk?.config || defaultConfig;
      const motivations = [
        config.motivation_1 || defaultConfig.motivation_1,
        config.motivation_2 || defaultConfig.motivation_2,
        config.motivation_3 || defaultConfig.motivation_3
      ];
      const randomMotivation = motivations[Math.floor(Math.random() * motivations.length)];

      content.innerHTML = `
        <div class="training-container">
          <button class="back-button">‚Üê –ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
          
          <div class="training-progress">
            <div class="progress-text">–í–æ–ø—Ä–æ—Å ${currentTraining.currentQuestion + 1} –∏–∑ ${currentTraining.questions.length}</div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: ${progress}%"></div>
            </div>
          </div>

          <div class="question-card">
            <div class="question-text">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥:</div>
            <div class="question-arabic">${question.arabic}</div>
            <div class="options-grid">
              ${optionsHTML}
            </div>
          </div>

          <div class="motivation-message">${randomMotivation}</div>
        </div>
      `;

      document.querySelector('.back-button').addEventListener('click', () => {
        currentTraining = null;
        currentLesson = null;
        renderLessons();
      });

      document.querySelectorAll('.option-btn').forEach(btn => {
        btn.addEventListener('click', async () => {
          const answer = btn.dataset.answer;
          const isCorrect = answer === question.correct;

          btn.classList.add(isCorrect ? 'correct' : 'incorrect');
          
          if (isCorrect) {
            currentTraining.correctAnswers++;
          }

          document.querySelectorAll('.option-btn').forEach(b => b.disabled = true);

          setTimeout(async () => {
            currentTraining.currentQuestion++;
            
            if (currentTraining.currentQuestion >= currentTraining.questions.length) {
              await finishTraining();
            } else {
              renderTrainingQuestion();
            }
          }, 1000);
        });
      });
    }

    async function finishTraining() {
      const lesson = currentTraining.lesson;
      const score = (currentTraining.correctAnswers / currentTraining.questions.length) * 100;

      if (score >= 70) {
        completedLessons.add(lesson.id);
        
        for (const word of lesson.words) {
          const existingWord = learnedWords.find(w => w.word === word.arabic);
          if (!existingWord) {
            const createResult = await window.dataSdk.create({
              lesson_id: lesson.id,
              word: word.arabic,
              translation: word.translation,
              completed: true
            });

            if (!createResult.isOk) {
              console.error("Failed to save word");
            }
          }
        }
      }

      const content = document.getElementById('mainContent');
      const nextLesson = LESSONS_DATA.find(l => l.id === lesson.id + 1);
      
      const buttonsHTML = score >= 70 ? `
        <button class="start-training-btn" id="homeBtn" style="margin-bottom: 1rem;">üè† –ì–ª–∞–≤–Ω–∞—è</button>
        <button class="start-training-btn" id="repeatBtn" style="margin-bottom: 1rem; background: linear-gradient(135deg, #7b2ff7, #b794f6);">üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
        ${nextLesson ? `<button class="start-training-btn" id="nextBtn">‚û°Ô∏è –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫</button>` : ''}
      ` : `
        <button class="start-training-btn" id="repeatBtn" style="margin-bottom: 1rem;">üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
        <button class="start-training-btn" id="homeBtn" style="background: linear-gradient(135deg, #7b2ff7, #b794f6);">üè† –ì–ª–∞–≤–Ω–∞—è</button>
      `;

      content.innerHTML = `
        <div class="training-container">
          <div class="question-card" style="text-align: center;">
            <div style="font-size: 4rem; margin-bottom: 1rem;">
              ${score >= 70 ? 'üéâ' : 'üí™'}
            </div>
            <h2 style="color: #00d4ff; margin-bottom: 1rem;">
              ${score >= 70 ? '–û—Ç–ª–∏—á–Ω–æ!' : '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑'}
            </h2>
            <div style="font-size: 2rem; color: #e0e6ed; margin-bottom: 2rem;">
              ${currentTraining.correctAnswers} –∏–∑ ${currentTraining.questions.length}
            </div>
            <div style="color: #8b92a8; margin-bottom: 2rem;">
              ${score >= 70 ? '–°–ª–æ–≤–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ª–æ–≤–∞—Ä—å!' : '–ù—É–∂–Ω–æ –Ω–∞–±—Ä–∞—Ç—å –º–∏–Ω–∏–º—É–º 70% –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–∫–∞'}
            </div>
            ${buttonsHTML}
          </div>
        </div>
      `;

      const homeBtn = document.getElementById('homeBtn');
      const repeatBtn = document.getElementById('repeatBtn');
      const nextBtn = document.getElementById('nextBtn');

      if (homeBtn) {
        homeBtn.addEventListener('click', () => {
          currentTraining = null;
          currentLesson = null;
          renderLessons();
        });
      }

      if (repeatBtn) {
        repeatBtn.addEventListener('click', () => {
          startTraining(lesson);
        });
      }

      if (nextBtn && nextLesson) {
        nextBtn.addEventListener('click', () => {
          currentLesson = nextLesson;
          renderLessonDetail(nextLesson);
        });
      }
    }

    function renderDictionary() {
      const content = document.getElementById('mainContent');

      if (learnedWords.length === 0) {
        content.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üìñ</div>
            <div class="empty-text">–ü—Ä–æ–π–¥–∏—Ç–µ —É—Ä–æ–∫–∏, —á—Ç–æ–±—ã –ø–æ–ø–æ–ª–Ω–∏—Ç—å —Å–ª–æ–≤–∞—Ä—å</div>
          </div>
        `;
        return;
      }

      const cardsHTML = learnedWords.map((word, index) => {
        return `
          <div class="dict-card" data-card-id="${index}">
            <div class="dict-card-front">
              <div class="word-arabic">${word.word}</div>
            </div>
            <div class="dict-card-back">
              <div class="word-translation">${word.translation}</div>
            </div>
          </div>
        `;
      }).join('');

      content.innerHTML = `
        <h2 style="color: #00d4ff; margin-bottom: 1.5rem; font-size: 1.8rem;">–ú–æ–π —Å–ª–æ–≤–∞—Ä—å (${learnedWords.length} —Å–ª–æ–≤)</h2>
        <div class="dictionary-grid">
          ${cardsHTML}
        </div>
      `;

      document.querySelectorAll('.dict-card').forEach(card => {
        card.addEventListener('click', () => {
          card.classList.toggle('flipped');
        });
      });
    }

    function renderVerbs() {
      const content = document.getElementById('mainContent');

      if (learnedWords.length === 0) {
        content.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">‚úçÔ∏è</div>
            <div class="empty-text">–°–Ω–∞—á–∞–ª–∞ –∏–∑—É—á–∏—Ç–µ —Å–ª–æ–≤–∞ –≤ —É—Ä–æ–∫–∞—Ö</div>
          </div>
        `;
        return;
      }

      const exercise = VERB_EXERCISES[Math.floor(Math.random() * VERB_EXERCISES.length)];
      const optionsHTML = exercise.options.map((option, index) => `
        <button class="option-btn" data-verb="${option}">
          <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">${option}</div>
          <div style="font-size: 0.9rem; color: #8b92a8;">${exercise.translations[index]}</div>
        </button>
      `).join('');

      content.innerHTML = `
        <div class="verb-exercise">
          <h2 style="color: #00d4ff; margin-bottom: 1.5rem; font-size: 1.8rem;">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ –≥–ª–∞–≥–æ–ª—ã</h2>
          
          <div class="question-card">
            <div class="question-text">${exercise.sentence}</div>
            <div class="question-arabic" style="font-size: 2.5rem; margin: 2rem 0;">${exercise.arabic}</div>
            <div style="color: #8b92a8; margin: 1.5rem 0;">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ñ–æ—Ä–º—É –≥–ª–∞–≥–æ–ª–∞:</div>
            <div class="options-grid">
              ${optionsHTML}
            </div>
          </div>
        </div>
      `;

      document.querySelectorAll('.option-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const verb = btn.dataset.verb;
          const isCorrect = verb === exercise.correctVerb;

          btn.classList.add(isCorrect ? 'correct' : 'incorrect');
          document.querySelectorAll('.option-btn').forEach(b => b.disabled = true);

          setTimeout(() => {
            renderVerbs();
          }, 1500);
        });
      });
    }

    function renderSentenceTraining() {
      const content = document.getElementById('mainContent');

      if (learnedWords.length === 0) {
        content.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üéØ</div>
            <div class="empty-text">–ò–∑—É—á–∏—Ç–µ —Å–ª–æ–≤–∞, —á—Ç–æ–±—ã —Å–æ–±–∏—Ä–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</div>
          </div>
        `;
        return;
      }

      // –§–∏–ª—å—Ç—Ä—É–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–æ –∏–∑—É—á–µ–Ω–Ω—ã–º —É—Ä–æ–∫–∞–º
      const completedLessonIds = Array.from(completedLessons);
      const availableExercises = SENTENCE_EXERCISES.filter(ex => 
        completedLessonIds.includes(ex.lessonId)
      );

      if (availableExercises.length === 0) {
        content.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üéØ</div>
            <div class="empty-text">–ü—Ä–æ–π–¥–∏—Ç–µ —É—Ä–æ–∫–∏, —á—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</div>
          </div>
        `;
        return;
      }

      // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–æ–≤—ã–º —É—Ä–æ–∫–∞–º (–ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑—É—á–µ–Ω–Ω—ã–µ)
      const sortedExercises = availableExercises.sort((a, b) => b.lessonId - a.lessonId);
      const exercise = sortedExercises[Math.floor(Math.random() * Math.min(5, sortedExercises.length))];
      const shuffledWords = [...exercise.words].sort(() => Math.random() - 0.5);

      content.innerHTML = `
        <div class="training-container">
          <h2 style="color: #00d4ff; margin-bottom: 1.5rem; font-size: 1.8rem;">–°–æ–±–µ—Ä–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</h2>
          
          <div class="sentence-builder">
            <div style="color: #8b92a8; margin-bottom: 1rem; text-align: center;">
              ${exercise.sentence}
            </div>
            
            <div class="drop-zone" id="dropZone">
              <div style="color: #8b92a8; opacity: 0.5;">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å–ª–æ–≤–∞ —Å—é–¥–∞</div>
            </div>

            <div class="words-pool" id="wordsPool">
              ${shuffledWords.map(word => `
                <div class="word-chip" draggable="true" data-word="${word}">${word}</div>
              `).join('')}
            </div>

            <button class="check-btn" id="checkBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          </div>
        </div>
      `;

      setupDragAndDrop(exercise.correct);
    }

    function setupDragAndDrop(correctOrder) {
      const dropZone = document.getElementById('dropZone');
      const wordsPool = document.getElementById('wordsPool');
      const checkBtn = document.getElementById('checkBtn');
      let draggedElement = null;

      document.querySelectorAll('.word-chip').forEach(chip => {
        chip.addEventListener('dragstart', (e) => {
          draggedElement = e.target;
          e.target.classList.add('dragging');
        });

        chip.addEventListener('dragend', (e) => {
          e.target.classList.remove('dragging');
        });

        chip.addEventListener('click', () => {
          if (chip.parentElement === wordsPool) {
            dropZone.appendChild(chip);
          } else {
            wordsPool.appendChild(chip);
          }
          updateDropZonePlaceholder();
        });
      });

      [dropZone, wordsPool].forEach(zone => {
        zone.addEventListener('dragover', (e) => {
          e.preventDefault();
        });

        zone.addEventListener('drop', (e) => {
          e.preventDefault();
          if (draggedElement) {
            zone.appendChild(draggedElement);
            updateDropZonePlaceholder();
          }
        });
      });

      function updateDropZonePlaceholder() {
        const placeholder = dropZone.querySelector('div[style*="opacity"]');
        if (placeholder) {
          placeholder.style.display = dropZone.querySelectorAll('.word-chip').length > 0 ? 'none' : 'block';
        }
      }

      checkBtn.addEventListener('click', () => {
        const userOrder = Array.from(dropZone.querySelectorAll('.word-chip')).map(chip => chip.dataset.word);
        const isCorrect = JSON.stringify(userOrder) === JSON.stringify(correctOrder);

        if (isCorrect) {
          dropZone.style.borderColor = '#00ff88';
          dropZone.style.background = 'rgba(0, 255, 136, 0.1)';
          checkBtn.textContent = '‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
          checkBtn.style.background = 'linear-gradient(135deg, #00ff88, #00d4ff)';
        } else {
          dropZone.style.borderColor = '#ff4444';
          dropZone.style.background = 'rgba(255, 68, 68, 0.1)';
          checkBtn.textContent = '‚úó –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑';
          checkBtn.style.background = 'linear-gradient(135deg, #ff4444, #ff6b6b)';
        }

        checkBtn.disabled = true;
      });
    }

    initApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a05352de6f43650',t:'MTc2MzQ0NTIwOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>